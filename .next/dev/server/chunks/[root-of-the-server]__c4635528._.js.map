{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///Users/haldwani/Documents/Working/preet-tech-next-gen-digital-agency%202/lib/googleSheetsService.ts"],"sourcesContent":["import { google } from 'googleapis';\n\nexport const getGoogleSheetsAuth = () => {\n    // If running in edge or missing vars this might complain, but we assume node runtime\n    const clientEmail = process.env.GOOGLE_CLIENT_EMAIL;\n    // Strip surrounding literal quotes if they accidentally got parsed, and ensure actual newline characters\n    const privateKey = process.env.GOOGLE_PRIVATE_KEY\n        ?.replace(/^\"|\"$/g, '')\n        ?.replace(/\\\\n/g, '\\n');\n\n    if (!clientEmail || !privateKey) {\n        throw new Error(\"Missing Google Service Account credentials.\");\n    }\n\n    return new google.auth.GoogleAuth({\n        credentials: {\n            client_email: clientEmail,\n            private_key: privateKey,\n        },\n        scopes: ['https://www.googleapis.com/auth/spreadsheets']\n    });\n};\n\nconst SHEET_ID = process.env.SHEET_ID;\nconst RANGE = 'A:D';\n\nexport const googleSheetsService = {\n    checkIfEmailExists: async (email: string) => {\n        try {\n            const auth = getGoogleSheetsAuth();\n            const sheets = google.sheets({ version: 'v4', auth });\n            const response = await sheets.spreadsheets.values.get({\n                spreadsheetId: SHEET_ID,\n                range: RANGE,\n            });\n            const rows = response.data.values || [];\n\n            // Assume Email is Column B (index 1)\n            return rows.some(row => row[1] === email);\n        } catch (error: any) {\n            console.error(\"Error checking sheet for email:\", error?.message || error);\n            throw new Error(`Google Sheets API Error: ${error?.message || 'Failed to read subscriber data'}`);\n        }\n    },\n\n    addSubscriber: async (name: string, email: string) => {\n        try {\n            const auth = getGoogleSheetsAuth();\n            const sheets = google.sheets({ version: 'v4', auth });\n\n            const date = new Date().toISOString();\n            const status = 'Active';\n\n            await sheets.spreadsheets.values.append({\n                spreadsheetId: SHEET_ID,\n                range: RANGE,\n                valueInputOption: 'USER_ENTERED',\n                requestBody: {\n                    values: [[name || 'Subscriber', email, date, status]]\n                }\n            });\n            return true;\n        } catch (error: any) {\n            console.error(\"Error appending to sheets:\", error?.message || error);\n            throw new Error(`Google API Append Error: ${error?.message || 'Failed to add subscriber'}`);\n        }\n    },\n\n    getActiveSubscribers: async () => {\n        try {\n            const auth = getGoogleSheetsAuth();\n            const sheets = google.sheets({ version: 'v4', auth });\n            const response = await sheets.spreadsheets.values.get({\n                spreadsheetId: SHEET_ID,\n                range: RANGE,\n            });\n            const rows = response.data.values || [];\n\n            // Skip the header row and filter active users\n            return rows.slice(1).filter(row => row[3] === 'Active').map(row => ({\n                name: row[0],\n                email: row[1]\n            }));\n        } catch (error) {\n            console.error(\"Error fetching subscribers list:\", error);\n            return [];\n        }\n    },\n\n    updateSubscriberStatus: async (email: string, status: string) => {\n        try {\n            const auth = getGoogleSheetsAuth();\n            const sheets = google.sheets({ version: 'v4', auth });\n            const response = await sheets.spreadsheets.values.get({\n                spreadsheetId: SHEET_ID,\n                range: RANGE,\n            });\n\n            const rows = response.data.values || [];\n\n            // Find row by email\n            const rowIndex = rows.findIndex(row => row[1] === email);\n            if (rowIndex === -1) return false;\n            const cellRange = `D${rowIndex + 1}`;\n            await sheets.spreadsheets.values.update({\n                spreadsheetId: SHEET_ID,\n                range: cellRange,\n                valueInputOption: 'USER_ENTERED',\n                requestBody: { values: [[status]] }\n            });\n\n            return true;\n        } catch (error: any) {\n            console.error(\"Error updating sheet status:\", error?.message || error);\n            throw new Error(`Google API Update Error: ${error?.message || 'Failed to update status'}`);\n        }\n    }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 299, "column": 0}, "map": {"version":3,"sources":["file:///Users/haldwani/Documents/Working/preet-tech-next-gen-digital-agency%202/lib/emailService.ts"],"sourcesContent":["import nodemailer from 'nodemailer';\n\nconst transporter = nodemailer.createTransport({\n    host: process.env.SMTP_HOST,\n    port: parseInt(process.env.SMTP_PORT || '465'),\n    secure: process.env.SMTP_PORT === '465', // true for 465, false for other ports\n    auth: {\n        user: process.env.SMTP_USER,\n        pass: process.env.SMTP_PASS,\n    },\n});\n\nexport const emailService = {\n    sendConfirmationEmail: async (email: string) => {\n        try {\n            const mailOptions = {\n                from: process.env.EMAIL_FROM || '\"Preet Tech\" <hello@preettech.com>',\n                to: email,\n                subject: \"Welcome to Preet Tech ðŸš€\",\n                html: `\n                    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; border: 1px solid #eaeaea; border-radius: 10px;\">\n                        <h2 style=\"color: #0f172a;\">Welcome to the Inner Circle!</h2>\n                        <p style=\"color: #475569; font-size: 16px;\">\n                            Thank you for joining our newsletter. You're now on the VIP list to receive our best actionable growth frameworks directly to your inbox. Zero fluff. Pure signal.\n                        </p>\n                        <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/blog\" style=\"display: inline-block; padding: 12px 24px; background-color: #0ed3e6; color: #0f172a; text-decoration: none; border-radius: 6px; font-weight: bold; margin-top: 15px;\">\n                            Read Latest Blogs\n                        </a>\n                        <p style=\"color: #94a3b8; font-size: 12px; margin-top: 30px;\">\n                            Need help? <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/contact\" style=\"color: #0ed3e6;\">Contact Support</a><br>\n                            To unsubscribe, <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/api/unsubscribe?email=${email}\" style=\"color: #94a3b8; text-decoration: underline;\">click here</a>.\n                        </p>\n                    </div>\n                `\n            };\n            await transporter.sendMail(mailOptions);\n            return true;\n        } catch (error) {\n            console.error(\"Nodemailer confirmation email error:\", error);\n            return false;\n        }\n    },\n\n    sendBlogNotification: async (emails: string[], blogData: { title: string, excerpt: string, slug: string }) => {\n        try {\n            const mailOptions = {\n                from: process.env.EMAIL_FROM || '\"Preet Tech\" <hello@preettech.com>',\n                bcc: emails.join(','),\n                subject: `New Blog: ${blogData.title} âœ¨`,\n                html: `\n                     <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; border: 1px solid #eaeaea; border-radius: 10px;\">\n                        <h2 style=\"color: #0f172a;\">New Intelligence Dropped!</h2>\n                        <h3 style=\"color: #0ed3e6;\">${blogData.title}</h3>\n                        <p style=\"color: #475569; font-size: 16px;\">\n                            ${blogData.excerpt}\n                        </p>\n                        <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/blog/${blogData.slug}\" style=\"display: inline-block; padding: 12px 24px; background-color: #0f172a; color: #ffffff; text-decoration: none; border-radius: 6px; font-weight: bold; margin-top: 15px;\">\n                            Read Full Article\n                        </a>\n                        <p style=\"color: #94a3b8; font-size: 12px; margin-top: 30px;\">\n                            To stop receiving these notifications, click to <a href=\"${process.env.NEXT_PUBLIC_APP_URL || 'http://localhost:3000'}/api/unsubscribe\" style=\"color: #94a3b8; text-decoration: underline;\">unsubscribe</a>.\n                        </p>\n                    </div>\n                `\n            };\n            await transporter.sendMail(mailOptions);\n            return true;\n        } catch (error) {\n            console.error(\"Nodemailer blog notification error:\", error);\n            return false;\n        }\n    }\n};\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,oNAAU,CAAC,eAAe,CAAC;IAC3C,MAAM,QAAQ,GAAG,CAAC,SAAS;IAC3B,MAAM,SAAS,QAAQ,GAAG,CAAC,SAAS,IAAI;IACxC,QAAQ,QAAQ,GAAG,CAAC,SAAS,KAAK;IAClC,MAAM;QACF,MAAM,QAAQ,GAAG,CAAC,SAAS;QAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;IAC/B;AACJ;AAEO,MAAM,eAAe;IACxB,uBAAuB,OAAO;QAC1B,IAAI;YACA,MAAM,cAAc;gBAChB,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;gBAChC,IAAI;gBACJ,SAAS;gBACT,MAAM,CAAC;;;;;;iCAMU,EAAE,8DAAmC,wBAAwB;;;;gDAI9C,EAAE,8DAAmC,wBAAwB;qDACxD,EAAE,8DAAmC,wBAAwB,uBAAuB,EAAE,MAAM;;;gBAGjI,CAAC;YACL;YACA,MAAM,YAAY,QAAQ,CAAC;YAC3B,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,wCAAwC;YACtD,OAAO;QACX;IACJ;IAEA,sBAAsB,OAAO,QAAkB;QAC3C,IAAI;YACA,MAAM,cAAc;gBAChB,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;gBAChC,KAAK,OAAO,IAAI,CAAC;gBACjB,SAAS,CAAC,UAAU,EAAE,SAAS,KAAK,CAAC,EAAE,CAAC;gBACxC,MAAM,CAAC;;;oDAG6B,EAAE,SAAS,KAAK,CAAC;;4BAEzC,EAAE,SAAS,OAAO,CAAC;;iCAEd,EAAE,8DAAmC,wBAAwB,MAAM,EAAE,SAAS,IAAI,CAAC;;;;qFAI/B,EAAE,8DAAmC,wBAAwB;;;gBAGlI,CAAC;YACL;YACA,MAAM,YAAY,QAAQ,CAAC;YAC3B,OAAO;QACX,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,uCAAuC;YACrD,OAAO;QACX;IACJ;AACJ"}},
    {"offset": {"line": 378, "column": 0}, "map": {"version":3,"sources":["file:///Users/haldwani/Documents/Working/preet-tech-next-gen-digital-agency%202/lib/validateEmail.ts"],"sourcesContent":["export const validateEmail = (email: string) => {\n    return String(email)\n        .toLowerCase()\n        .match(\n            /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|.(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/\n        );\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,gBAAgB,CAAC;IAC1B,OAAO,OAAO,OACT,WAAW,GACX,KAAK,CACF;AAEZ"}},
    {"offset": {"line": 389, "column": 0}, "map": {"version":3,"sources":["file:///Users/haldwani/Documents/Working/preet-tech-next-gen-digital-agency%202/app/api/subscribe/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { googleSheetsService } from '@/lib/googleSheetsService';\nimport { emailService } from '@/lib/emailService';\nimport { validateEmail } from '@/lib/validateEmail';\n\nexport async function POST(req: Request) {\n    try {\n        const body = await req.json();\n        const { name, email } = body;\n\n        if (!email || !validateEmail(email)) {\n            return NextResponse.json({ success: false, message: \"Valid email is required\" }, { status: 400 });\n        }\n\n        const exists = await googleSheetsService.checkIfEmailExists(email);\n\n        if (exists) {\n            return NextResponse.json({ success: true, message: \"Already Subscribed\" }, { status: 200 });\n        }\n\n        await googleSheetsService.addSubscriber(name || 'Subscriber', email);\n\n        // Send email notification to subscriber\n        await emailService.sendConfirmationEmail(email);\n\n        return NextResponse.json({ success: true, message: \"Subscription successful\" }, { status: 200 });\n    } catch (error: any) {\n        console.error(\"Subscription Error:\", error);\n        return NextResponse.json({ success: false, message: error.message || \"Failed to subscribe.\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG;QAExB,IAAI,CAAC,SAAS,CAAC,IAAA,+LAAa,EAAC,QAAQ;YACjC,OAAO,wMAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,SAAS;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QACnG;QAEA,MAAM,SAAS,MAAM,2MAAmB,CAAC,kBAAkB,CAAC;QAE5D,IAAI,QAAQ;YACR,OAAO,wMAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,SAAS;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC7F;QAEA,MAAM,2MAAmB,CAAC,aAAa,CAAC,QAAQ,cAAc;QAE9D,wCAAwC;QACxC,MAAM,6LAAY,CAAC,qBAAqB,CAAC;QAEzC,OAAO,wMAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAA0B,GAAG;YAAE,QAAQ;QAAI;IAClG,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,wMAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,SAAS,MAAM,OAAO,IAAI;QAAuB,GAAG;YAAE,QAAQ;QAAI;IACjH;AACJ"}}]
}